{"remainingRequest":"/home/thanh/DOAN/vue-admin-frontend/node_modules/babel-loader/lib/index.js!/home/thanh/DOAN/vue-admin-frontend/node_modules/eslint-loader/index.js??ref--13-0!/home/thanh/DOAN/vue-admin-frontend/src/store/store.js","dependencies":[{"path":"/home/thanh/DOAN/vue-admin-frontend/src/store/store.js","mtime":1640099395425},{"path":"/home/thanh/DOAN/vue-admin-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1638461276469},{"path":"/home/thanh/DOAN/vue-admin-frontend/node_modules/babel-loader/lib/index.js","mtime":1638461225625},{"path":"/home/thanh/DOAN/vue-admin-frontend/node_modules/eslint-loader/index.js","mtime":1638351065707}],"contextDependencies":[],"result":["import Vue from 'vue';\nimport Vuex from 'vuex';\nimport axios from 'axios';\nimport createPersistedState from 'vuex-persistedstate';\nVue.use(Vuex);\nexport default new Vuex.Store({\n  state: {\n    status: '',\n    token: localStorage.getItem('token') || '',\n    user: {},\n    role: null\n  },\n  plugins: [createPersistedState()],\n  mutations: {\n    auth_request: function auth_request(state) {\n      state.status = 'loading';\n    },\n    auth_success: function auth_success(state, _ref) {\n      var token = _ref.token,\n          user = _ref.user,\n          role = _ref.role;\n      state.status = 'success';\n      state.token = token;\n      state.user = user;\n      state.role = role;\n    },\n    auth_error: function auth_error(state) {\n      state.status = 'error';\n    },\n    logout: function logout(state) {\n      state.status = '';\n      state.token = '';\n      state.role = null;\n      state.user = null;\n    }\n  },\n  actions: {\n    loginUser: function loginUser(_ref2, user) {\n      var commit = _ref2.commit;\n      return new Promise(function (resolve, reject) {\n        commit('auth_request');\n        axios({\n          url: 'http://localhost:8000/api/system/login',\n          data: user,\n          method: 'POST'\n        }).then(function (resp) {\n          if (resp.data.status_code != 200) {\n            // console.log(\"response\", resp)\n            commit('auth_error');\n            localStorage.removeItem('token');\n            console.log(\"err\", err);\n            console.log(\"err\", resp);\n            reject(resp.data.message);\n          } else {\n            var token = resp.data.data.access_token;\n            var _user = resp.data.data.user;\n            var role = resp.data.data.role; // console.log(\"user\",user)\n\n            localStorage.setItem('token', token);\n            localStorage.setItem('role', role);\n            localStorage.setItem('user', _user.id);\n            axios.defaults.headers.common['Authorization'] = token;\n            axios.defaults.headers.common['Authorization'] = \"Bearer \" + token;\n            commit('auth_success', {\n              token: token,\n              user: _user,\n              role: role\n            });\n            resolve(resp);\n            console.log(\"response\", resp);\n          }\n        }).catch();\n      });\n    },\n    registerAdmin: function registerAdmin(_ref3, user) {\n      var commit = _ref3.commit;\n      return new Promise(function (resolve, reject) {\n        commit('auth_request');\n        axios({\n          url: 'http://localhost:8000/api/admin/register',\n          data: user,\n          method: 'POST'\n        }).then(function (resp) {\n          resolve(resp);\n        }).catch(function (err) {\n          commit('auth_error', err);\n          localStorage.removeItem('token');\n          reject(err);\n        });\n      });\n    },\n    registerStudent: function registerStudent(_ref4, user) {\n      var commit = _ref4.commit;\n      return new Promise(function (resolve, reject) {\n        commit('auth_request');\n        axios({\n          url: 'http://localhost:8000/api/student/register',\n          data: user,\n          method: 'POST'\n        }).then(function (resp) {\n          resolve(resp);\n        }).catch(function (err) {\n          commit('auth_error', err);\n          localStorage.removeItem('token');\n          reject(err);\n        });\n      });\n    },\n    registerTeacher: function registerTeacher(_ref5, user) {\n      var commit = _ref5.commit;\n      return new Promise(function (resolve, reject) {\n        commit('auth_request');\n        axios({\n          url: 'http://localhost:8000/api/user/register',\n          data: user,\n          method: 'POST'\n        }).then(function (resp) {\n          resolve(resp);\n        }).catch(function (err) {\n          commit('auth_error', err);\n          localStorage.removeItem('token');\n          reject(err);\n        });\n      });\n    },\n    logout: function logout(_ref6) {\n      var commit = _ref6.commit;\n      return new Promise(function (resolve, reject) {\n        commit('logout');\n        localStorage.removeItem('token');\n        delete axios.defaults.headers.common['Authorization'];\n        resolve();\n      });\n    }\n  },\n  getters: {\n    isLoggedIn: function isLoggedIn(state) {\n      return !!state.token;\n    },\n    authStatus: function authStatus(state) {\n      return state.status;\n    },\n    user: function user(state) {\n      return state.user;\n    },\n    role: function role(state) {\n      return state.role;\n    }\n  }\n});",{"version":3,"sources":["/home/thanh/DOAN/vue-admin-frontend/src/store/store.js"],"names":["Vue","Vuex","axios","createPersistedState","use","Store","state","status","token","localStorage","getItem","user","role","plugins","mutations","auth_request","auth_success","auth_error","logout","actions","loginUser","commit","Promise","resolve","reject","url","data","method","then","resp","status_code","removeItem","console","log","err","message","access_token","setItem","id","defaults","headers","common","catch","registerAdmin","registerStudent","registerTeacher","getters","isLoggedIn","authStatus"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,oBAAP,MAAiC,qBAAjC;AACAH,GAAG,CAACI,GAAJ,CAAQH,IAAR;AAEA,eAAe,IAAIA,IAAI,CAACI,KAAT,CAAe;AAC5BC,EAAAA,KAAK,EAAE;AACLC,IAAAA,MAAM,EAAE,EADH;AAELC,IAAAA,KAAK,EAAEC,YAAY,CAACC,OAAb,CAAqB,OAArB,KAAiC,EAFnC;AAGLC,IAAAA,IAAI,EAAG,EAHF;AAILC,IAAAA,IAAI,EAAG;AAJF,GADqB;AAO5BC,EAAAA,OAAO,EAAE,CAACV,oBAAoB,EAArB,CAPmB;AAQ5BW,EAAAA,SAAS,EAAE;AACPC,IAAAA,YADO,wBACMT,KADN,EACY;AACjBA,MAAAA,KAAK,CAACC,MAAN,GAAe,SAAf;AACD,KAHM;AAIPS,IAAAA,YAJO,wBAIMV,KAJN,QAIiC;AAAA,UAAnBE,KAAmB,QAAnBA,KAAmB;AAAA,UAAZG,IAAY,QAAZA,IAAY;AAAA,UAANC,IAAM,QAANA,IAAM;AACtCN,MAAAA,KAAK,CAACC,MAAN,GAAe,SAAf;AACAD,MAAAA,KAAK,CAACE,KAAN,GAAcA,KAAd;AACAF,MAAAA,KAAK,CAACK,IAAN,GAAaA,IAAb;AACAL,MAAAA,KAAK,CAACM,IAAN,GAAaA,IAAb;AACD,KATM;AAUPK,IAAAA,UAVO,sBAUIX,KAVJ,EAUU;AACfA,MAAAA,KAAK,CAACC,MAAN,GAAe,OAAf;AACD,KAZM;AAaPW,IAAAA,MAbO,kBAaAZ,KAbA,EAaM;AACXA,MAAAA,KAAK,CAACC,MAAN,GAAe,EAAf;AACAD,MAAAA,KAAK,CAACE,KAAN,GAAc,EAAd;AACAF,MAAAA,KAAK,CAACM,IAAN,GAAa,IAAb;AACAN,MAAAA,KAAK,CAACK,IAAN,GAAa,IAAb;AACD;AAlBM,GARiB;AA4B5BQ,EAAAA,OAAO,EAAE;AACPC,IAAAA,SADO,4BACaT,IADb,EACkB;AAAA,UAAdU,MAAc,SAAdA,MAAc;AACrB,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCH,QAAAA,MAAM,CAAC,cAAD,CAAN;AACAnB,QAAAA,KAAK,CAAC;AAACuB,UAAAA,GAAG,EAAE,wCAAN;AAAgDC,UAAAA,IAAI,EAAEf,IAAtD;AAA4DgB,UAAAA,MAAM,EAAE;AAApE,SAAD,CAAL,CACCC,IADD,CACM,UAAAC,IAAI,EAAI;AACV,cAAGA,IAAI,CAACH,IAAL,CAAUI,WAAV,IAAuB,GAA1B,EAA8B;AAC5B;AACAT,YAAAA,MAAM,CAAC,YAAD,CAAN;AACAZ,YAAAA,YAAY,CAACsB,UAAb,CAAwB,OAAxB;AACAC,YAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAkBC,GAAlB;AACAF,YAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAkBJ,IAAlB;AACAL,YAAAA,MAAM,CAACK,IAAI,CAACH,IAAL,CAAUS,OAAX,CAAN;AACD,WAPD,MAQI;AACN,gBAAM3B,KAAK,GAAGqB,IAAI,CAACH,IAAL,CAAUA,IAAV,CAAeU,YAA7B;AACA,gBAAMzB,KAAI,GAAGkB,IAAI,CAACH,IAAL,CAAUA,IAAV,CAAef,IAA5B;AACA,gBAAMC,IAAI,GAAGiB,IAAI,CAACH,IAAL,CAAUA,IAAV,CAAed,IAA5B,CAHM,CAIN;;AACAH,YAAAA,YAAY,CAAC4B,OAAb,CAAqB,OAArB,EAA8B7B,KAA9B;AACAC,YAAAA,YAAY,CAAC4B,OAAb,CAAqB,MAArB,EAA6BzB,IAA7B;AACAH,YAAAA,YAAY,CAAC4B,OAAb,CAAqB,MAArB,EAA4B1B,KAAI,CAAC2B,EAAjC;AACApC,YAAAA,KAAK,CAACqC,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,IAAiDjC,KAAjD;AACAN,YAAAA,KAAK,CAACqC,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,IAAiD,YAAYjC,KAA7D;AACAa,YAAAA,MAAM,CAAC,cAAD,EAAiB;AAACb,cAAAA,KAAK,EAALA,KAAD;AAAQG,cAAAA,IAAI,EAAJA,KAAR;AAAcC,cAAAA,IAAI,EAAJA;AAAd,aAAjB,CAAN;AAEAW,YAAAA,OAAO,CAACM,IAAD,CAAP;AACAG,YAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAuBJ,IAAvB;AACG;AACJ,SAzBD,EA0BCa,KA1BD;AA6BD,OA/BM,CAAP;AAgCH,KAlCM;AAmCPC,IAAAA,aAnCO,gCAmCiBhC,IAnCjB,EAmCsB;AAAA,UAAdU,MAAc,SAAdA,MAAc;AACzB,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCH,QAAAA,MAAM,CAAC,cAAD,CAAN;AACAnB,QAAAA,KAAK,CAAC;AAACuB,UAAAA,GAAG,EAAE,0CAAN;AAAkDC,UAAAA,IAAI,EAAEf,IAAxD;AAA8DgB,UAAAA,MAAM,EAAE;AAAtE,SAAD,CAAL,CACCC,IADD,CACM,UAAAC,IAAI,EAAI;AACZN,UAAAA,OAAO,CAACM,IAAD,CAAP;AACD,SAHD,EAICa,KAJD,CAIO,UAAAR,GAAG,EAAI;AACZb,UAAAA,MAAM,CAAC,YAAD,EAAea,GAAf,CAAN;AACAzB,UAAAA,YAAY,CAACsB,UAAb,CAAwB,OAAxB;AACAP,UAAAA,MAAM,CAACU,GAAD,CAAN;AACD,SARD;AASD,OAXM,CAAP;AAYD,KAhDI;AAiDPU,IAAAA,eAjDO,kCAiDmBjC,IAjDnB,EAiDwB;AAAA,UAAdU,MAAc,SAAdA,MAAc;AAC3B,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCH,QAAAA,MAAM,CAAC,cAAD,CAAN;AACAnB,QAAAA,KAAK,CAAC;AAACuB,UAAAA,GAAG,EAAE,4CAAN;AAAoDC,UAAAA,IAAI,EAAEf,IAA1D;AAAgEgB,UAAAA,MAAM,EAAE;AAAxE,SAAD,CAAL,CACCC,IADD,CACM,UAAAC,IAAI,EAAI;AACZN,UAAAA,OAAO,CAACM,IAAD,CAAP;AACD,SAHD,EAICa,KAJD,CAIO,UAAAR,GAAG,EAAI;AACZb,UAAAA,MAAM,CAAC,YAAD,EAAea,GAAf,CAAN;AACAzB,UAAAA,YAAY,CAACsB,UAAb,CAAwB,OAAxB;AACAP,UAAAA,MAAM,CAACU,GAAD,CAAN;AACD,SARD;AASD,OAXM,CAAP;AAYD,KA9DI;AA+DPW,IAAAA,eA/DO,kCA+DmBlC,IA/DnB,EA+DwB;AAAA,UAAdU,MAAc,SAAdA,MAAc;AAC3B,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCH,QAAAA,MAAM,CAAC,cAAD,CAAN;AACAnB,QAAAA,KAAK,CAAC;AAACuB,UAAAA,GAAG,EAAE,yCAAN;AAAiDC,UAAAA,IAAI,EAAEf,IAAvD;AAA6DgB,UAAAA,MAAM,EAAE;AAArE,SAAD,CAAL,CACCC,IADD,CACM,UAAAC,IAAI,EAAI;AACZN,UAAAA,OAAO,CAACM,IAAD,CAAP;AACD,SAHD,EAICa,KAJD,CAIO,UAAAR,GAAG,EAAI;AACZb,UAAAA,MAAM,CAAC,YAAD,EAAea,GAAf,CAAN;AACAzB,UAAAA,YAAY,CAACsB,UAAb,CAAwB,OAAxB;AACAP,UAAAA,MAAM,CAACU,GAAD,CAAN;AACD,SARD;AASD,OAXM,CAAP;AAYD,KA5EI;AA6EPhB,IAAAA,MA7EO,yBA6ES;AAAA,UAARG,MAAQ,SAARA,MAAQ;AACZ,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCH,QAAAA,MAAM,CAAC,QAAD,CAAN;AACAZ,QAAAA,YAAY,CAACsB,UAAb,CAAwB,OAAxB;AACA,eAAO7B,KAAK,CAACqC,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,CAAP;AACAlB,QAAAA,OAAO;AACR,OALM,CAAP;AAMD;AApFI,GA5BmB;AAkH5BuB,EAAAA,OAAO,EAAG;AACRC,IAAAA,UAAU,EAAE,oBAAAzC,KAAK;AAAA,aAAI,CAAC,CAACA,KAAK,CAACE,KAAZ;AAAA,KADT;AAERwC,IAAAA,UAAU,EAAE,oBAAA1C,KAAK;AAAA,aAAIA,KAAK,CAACC,MAAV;AAAA,KAFT;AAGRI,IAAAA,IAAI,EAAG,cAAAL,KAAK;AAAA,aAAIA,KAAK,CAACK,IAAV;AAAA,KAHJ;AAIRC,IAAAA,IAAI,EAAG,cAAAN,KAAK;AAAA,aAAIA,KAAK,CAACM,IAAV;AAAA;AAJJ;AAlHkB,CAAf,CAAf","sourcesContent":["import Vue from 'vue'\nimport Vuex from 'vuex'\nimport axios from 'axios'\nimport createPersistedState from 'vuex-persistedstate';\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n  state: {\n    status: '',\n    token: localStorage.getItem('token') || '',\n    user : {},\n    role : null\n  },\n  plugins: [createPersistedState()],\n  mutations: {\n      auth_request(state){\n        state.status = 'loading'\n      },\n      auth_success(state, {token, user, role}){\n        state.status = 'success'\n        state.token = token\n        state.user = user\n        state.role = role\n      },\n      auth_error(state){\n        state.status = 'error'\n      },\n      logout(state){\n        state.status = ''\n        state.token = '' \n        state.role = null\n        state.user = null\n      },\n  },\n  actions: {\n    loginUser({commit}, user){\n        return new Promise((resolve, reject) => {\n          commit('auth_request')\n          axios({url: 'http://localhost:8000/api/system/login', data: user, method: 'POST' })\n          .then(resp => {\n              if(resp.data.status_code!=200){\n                // console.log(\"response\", resp)\n                commit('auth_error')\n                localStorage.removeItem('token')\n                console.log(\"err\",err);\n                console.log(\"err\",resp);\n                reject(resp.data.message)\n              }\n              else{\n            const token = resp.data.data.access_token\n            const user = resp.data.data.user\n            const role = resp.data.data.role\n            // console.log(\"user\",user)\n            localStorage.setItem('token', token)\n            localStorage.setItem('role', role)\n            localStorage.setItem('user',user.id)\n            axios.defaults.headers.common['Authorization'] = token\n            axios.defaults.headers.common['Authorization'] = \"Bearer \" + token\n            commit('auth_success', {token, user, role})\n            \n            resolve(resp)\n            console.log(\"response\",resp)\n              }\n          })\n          .catch(\n            \n          )\n        })\n    }, \n    registerAdmin({commit}, user){\n        return new Promise((resolve, reject) => {\n          commit('auth_request')\n          axios({url: 'http://localhost:8000/api/admin/register', data: user, method: 'POST' })\n          .then(resp => {\n            resolve(resp)\n          })\n          .catch(err => {\n            commit('auth_error', err)\n            localStorage.removeItem('token')\n            reject(err)\n          })\n        })\n      },\n    registerStudent({commit}, user){\n        return new Promise((resolve, reject) => {\n          commit('auth_request')\n          axios({url: 'http://localhost:8000/api/student/register', data: user, method: 'POST' })\n          .then(resp => {\n            resolve(resp)\n          })\n          .catch(err => {\n            commit('auth_error', err)\n            localStorage.removeItem('token')\n            reject(err)\n          })\n        })\n      },\n    registerTeacher({commit}, user){\n        return new Promise((resolve, reject) => {\n          commit('auth_request')\n          axios({url: 'http://localhost:8000/api/user/register', data: user, method: 'POST' })\n          .then(resp => {\n            resolve(resp)\n          })\n          .catch(err => {\n            commit('auth_error', err)\n            localStorage.removeItem('token')\n            reject(err)\n          })\n        })\n      },\n    logout({commit}){\n        return new Promise((resolve, reject) => {\n          commit('logout')\n          localStorage.removeItem('token')\n          delete axios.defaults.headers.common['Authorization']\n          resolve()\n        })\n      }\n  },\n  getters : {\n    isLoggedIn: state => !!state.token,\n    authStatus: state => state.status,\n    user : state => state.user,\n    role : state => state.role\n  }\n})"]}]}