{"remainingRequest":"/home/thanh/DOAN/vue-admin-frontend/node_modules/babel-loader/lib/index.js!/home/thanh/DOAN/vue-admin-frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/thanh/DOAN/vue-admin-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/thanh/DOAN/vue-admin-frontend/src/views/admins/UploadExcelTeacher.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/thanh/DOAN/vue-admin-frontend/src/views/admins/UploadExcelTeacher.vue","mtime":1639819412281},{"path":"/home/thanh/DOAN/vue-admin-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1638461276469},{"path":"/home/thanh/DOAN/vue-admin-frontend/node_modules/babel-loader/lib/index.js","mtime":1638461225625},{"path":"/home/thanh/DOAN/vue-admin-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1638461276469},{"path":"/home/thanh/DOAN/vue-admin-frontend/node_modules/vue-loader/lib/index.js","mtime":1638461277198}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.typed.uint8-array\";\nimport \"core-js/modules/es6.function.name\";\nimport _TableColumn2 from \"element-ui/lib/theme-chalk/table-column.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _TableColumn from \"element-ui/lib/table-column\";\nimport _Table2 from \"element-ui/lib/theme-chalk/table.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Table from \"element-ui/lib/table\";\nimport _Main2 from \"element-ui/lib/theme-chalk/main.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Main from \"element-ui/lib/main\";\nimport _ButtonGroup2 from \"element-ui/lib/theme-chalk/button-group.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _ButtonGroup from \"element-ui/lib/button-group\";\nimport _Upload2 from \"element-ui/lib/theme-chalk/upload.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Upload from \"element-ui/lib/upload\";\nimport _Button2 from \"element-ui/lib/theme-chalk/button.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Button from \"element-ui/lib/button\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport XLSX from \"xlsx\";\nimport Vue from \"vue\";\nVue.use(XLSX);\n// import { event } from 'd3';\nimport { get, put, del, post } from \"../../services/services\";\nimport Notifications from \"../../components/NotificationPlugin/Notifications.vue\";\nVue.use(_Button);\nVue.use(_Upload);\nVue.use(_ButtonGroup);\nVue.use(_Main);\nVue.use(_Table);\nVue.use(_TableColumn);\nexport default {\n  components: {\n    Notifications: Notifications\n  },\n  data: function data() {\n    return {\n      limitUpload: 1,\n      fileTemp: null,\n      file: null,\n      fileName: null,\n      da: [],\n      fileList: [],\n      dalen: 0\n    };\n  },\n  watch: {\n    \"$route.params.id\": function $routeParamsId(id) {\n      this.handleUpload();\n    }\n  },\n  methods: {\n    handlePreview: function handlePreview(file) {\n      console.log(file);\n    },\n    handleChange: function handleChange(file, fileList) {\n      this.fileTemp = file.raw;\n\n      if (this.fileTemp) {\n        if (this.fileTemp.type == \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" || this.fileTemp.type == \"application/vnd.ms-excel\") {\n          this.importfxx(this.fileTemp);\n        } else {\n          this.$message({\n            type: \"warning\",\n            message: \"Định dạng của tệp đính kèm là sai, vui lòng xóa nó và tải lên lại!\"\n          });\n        }\n      } else {\n        this.$message({\n          type: \"warning\",\n          message: \"Vui lòng tải lên tệp đính kèm！\"\n        });\n      }\n    },\n    handleExceed: function handleExceed() {\n      this.$message({\n        type: \"warning\",\n        message: \"超出最大上传文件数量的限制！\"\n      });\n      return;\n    },\n    handleRemove: function handleRemove() {\n      this.fileTemp = null;\n      this.da = null;\n      this.dalen = 0;\n      this.fileName = null;\n      return this.$refs.table.reload;\n    },\n    importfxx: function importfxx(obj) {\n      var _this = this;\n\n      var inputDOM = this.$refs.inputer; // 通过DOM取文件数据\n\n      console.log(\"obj name\", obj.name); // this.file = event.currentTarget.files[0];\n\n      this.fileName = obj.name;\n      this.file = obj;\n      var rABS = false; //是否将文件读取为二进制字符串\n\n      var f = this.file;\n      var reader = new FileReader(); //if (!FileReader.prototype.readAsBinaryString) {\n\n      FileReader.prototype.readAsBinaryString = function (f) {\n        var binary = \"\";\n        var rABS = false; //是否将文件读取为二进制字符串\n\n        var pt = this;\n        var wb; //读取完成的数据\n\n        var outdata;\n        var reader = new FileReader();\n\n        reader.onload = function (e) {\n          var bytes = new Uint8Array(reader.result);\n          var length = bytes.byteLength;\n\n          for (var i = 0; i < length; i++) {\n            binary += String.fromCharCode(bytes[i]);\n          }\n\n          var XLSX = require(\"xlsx\");\n\n          if (rABS) {\n            wb = XLSX.read(btoa(fixdata(binary)), {\n              //手动转化\n              type: \"base64\"\n            });\n          } else {\n            wb = XLSX.read(binary, {\n              type: \"binary\",\n              cellDates: true,\n              dateNF: 'yyyy/mm/dd;@'\n            });\n          }\n\n          outdata = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]], {\n            raw: false\n          }); //outdata就是你想要的东西\n          // console.log('未处理的原始数据如下：');\n\n          console.log('outdata', outdata); //此处可对数据进行处理\n\n          var arr = [];\n          outdata.map(function (v) {\n            var obj = {};\n            var nameTemp = []; // console.log(\"obj\", obj)\n\n            obj.fullname = v[\"Fullname\"];\n            obj.username = v[\"Username\"];\n            obj.email = v[\"Email\"];\n            obj.password = v[\"Password\"];\n            obj.phone = v[\"Telephone\"];\n            obj.gender = v[\"Gender\"];\n            nameTemp = obj.email.split('@');\n            var birthdayTemp = v[\"Birthday\"]; // console.log(\"XXX\", birthdayTemp)\n\n            var birthdayArray = birthdayTemp.split(\"/\");\n            var birthday = new Date(birthdayArray[2], birthdayArray[1], birthdayArray[0]);\n            obj.birthdayYear = parseInt(birthdayArray[2]);\n            obj.birthdayMonth = birthday.getMonth();\n            obj.birthdayDate = birthday.getDate();\n            arr.push(obj);\n          });\n          _this.da = arr;\n          _this.dalen = arr.length;\n          console.log('data', _this.da);\n          console.log('dataleng', _this.dalen);\n          console.log('arr', arr);\n          return arr;\n        };\n\n        reader.readAsArrayBuffer(f);\n      }; // console.log(this.da)\n\n\n      if (rABS) {\n        reader.readAsArrayBuffer(f);\n      } else {\n        reader.readAsBinaryString(f);\n      }\n    },\n    handleUpload: function handleUpload() {\n      var _this2 = this;\n\n      // console.log(this.da);\n      var url = \"http://localhost:8000/api/admin/teacher/upload/\" + this.$route.params.id;\n      console.log(\"url\", url);\n      var payload = {\n        data: []\n      };\n      payload.data = this.da;\n      console.log('payload', payload.data);\n      post(url, payload).then(function (res) {\n        console.log(\"Respon\", res);\n\n        if (res.data.count < 0) {\n          _this2.showNotification(\"danger\", \"Học sinh thuộc lớp không có trong hệ thống\");\n\n          _this2.handleRemove();\n        } else {\n          _this2.showNotification(\"success\", \"Đã lưu dữ liệu thành công\");\n\n          _this2.handleRemove();\n        }\n      }).catch(function (err) {\n        //   alert(err);\n        console.log(\"Respon\", err);\n\n        _this2.showNotification(\"danger\", \"Dữ liệu không hợp lệ\");\n\n        _this2.handleRemove();\n      });\n    },\n    showNotification: function showNotification(type, message) {\n      this.$notify({\n        message: message,\n        icon: \"add_alert\",\n        horizontalAlign: 'right',\n        verticalAlign: 'top',\n        type: type\n      });\n    }\n  } // mounted(file,fileList){\n  //   this.handleChange(file,fileList);\n  // }\n\n};",{"version":3,"sources":["UploadExcelTeacher.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n      <notifications></notifications>\n    <base-header class=\"pb-6 pb-8 pt-5 pt-md-8 bg-gradient-success\">\n      <!-- Card stats -->\n    </base-header>\n    <div>\n      <!--limit:最大上传数，on-exceed：超过最大上传数量时的操作  -->\n      <el-upload\n        v-if=\"dalen < 1\"\n        class=\"upload-demo\"\n        action=\"\"\n        :on-change=\"handleChange\"\n        :on-remove=\"handleRemove\"\n        :on-preview=\"handlePreview\"\n        :on-exceed=\"handleExceed\"\n        :limit=\"limitUpload\"\n        accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel\"\n        :auto-upload=\"false\"\n        :file-list=\"fileList\"\n      >\n        <el-button size=\"small\" type=\"primary\" v-if=\"dalen < 1\">Tải tệp lên</el-button>\n        <!-- <div slot=\"tip\" class=\"el-upload__tip\">只 能 上 传 xlsx / xls 文 件</div> -->\n      </el-upload>\n\n      <!-- 数据展示 -->\n      <h1 class=\"title\">{{fileName}}</h1>\n      <el-main v-if=\"dalen > 0\">\n        <el-table :data=\"da\" ref=\"table\">\n          <!-- <el-table-column prop=\"code\" label=\"Code\"> </el-table-column> -->\n          <el-table-column prop=\"username\" label=\"Username\" min-width=\"100px\" align=\"center\"> </el-table-column>\n          <el-table-column prop=\"fullname\" label=\"Fullname\" align=\"center\"> </el-table-column>\n          <el-table-column prop=\"phone\" label=\"Telephone\" align=\"center\"> </el-table-column>\n          <el-table-column prop=\"email\" min-width=\"130px\" label=\"Email\" align=\"center\"> </el-table-column>\n          <el-table-column prop=\"level\" min-width=\"130px\" label=\"Level\" align=\"center\"> </el-table-column>\n          <el-table-column prop=\"password\" min-width=\"130px\" label=\"Password\" align=\"center\"> </el-table-column>\n          <el-table-column prop=\"gender\" min-width=\"45px\" label=\"Gender\" align=\"center\"> </el-table-column>\n        </el-table>\n      </el-main>\n      <div style=\"text-align: center;\">\n      <el-button type=\"success\" @click=\"handleUpload\" v-if=\"dalen > 0\" \n        >Hoàn thành</el-button\n      >\n      <el-button type=\"danger\" @click=\"handleRemove\" v-if=\"dalen > 0\" \n        >Huỷ</el-button\n      >\n      </div>\n\n    </div>\n  </div>\n</template>\n<script>\nimport XLSX from \"xlsx\";\nimport Vue from \"vue\";\nVue.use(XLSX);\nimport {\n  Upload,\n  Button,\n  ButtonGroup,\n  Main,\n  Table,\n  TableColumn,\n} from \"element-ui\";\n// import { event } from 'd3';\nimport { get, put, del, post } from \"../../services/services\";\nimport Notifications from '../../components/NotificationPlugin/Notifications.vue';\nVue.use(Button);\nVue.use(Upload);\nVue.use(ButtonGroup);\nVue.use(Main);\nVue.use(Table);\nVue.use(TableColumn);\nexport default {\n  components: { Notifications },\n  data() {\n    return {\n      limitUpload: 1,\n      fileTemp: null,\n      file: null,\n      fileName: null,\n      da: [],\n      fileList: [],\n      dalen: 0,\n    };\n  },\n  watch: {\n    \"$route.params.id\": function (id) {\n      this.handleUpload();\n    },    \n  },\n  methods: {\n      handlePreview(file) {\n        console.log(file);\n      },\n    handleChange(file, fileList) {\n      this.fileTemp = file.raw;\n      if (this.fileTemp) {\n        if (\n          this.fileTemp.type ==\n            \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\" ||\n          this.fileTemp.type == \"application/vnd.ms-excel\"\n        ) {\n          this.importfxx(this.fileTemp);\n        } else {\n          this.$message({\n            type: \"warning\",\n            message: \"Định dạng của tệp đính kèm là sai, vui lòng xóa nó và tải lên lại!\",\n          });\n        }\n      } else {\n        this.$message({\n          type: \"warning\",\n          message: \"Vui lòng tải lên tệp đính kèm！\",\n        });\n      }\n    },\n    handleExceed() {\n      this.$message({\n        type: \"warning\",\n        message: \"超出最大上传文件数量的限制！\",\n      });\n      return;\n    },\n    handleRemove() {\n      this.fileTemp = null;\n      this.da = null;\n      this.dalen = 0;\n      this.fileName = null\n      return this.$refs.table.reload;\n    },\n    importfxx(obj) {\n      let _this = this;\n      let inputDOM = this.$refs.inputer;\n      // 通过DOM取文件数据\n      console.log(\"obj name\",obj.name);\n      // this.file = event.currentTarget.files[0];\n      this.fileName = obj.name\n      this.file = obj;\n      var rABS = false; //是否将文件读取为二进制字符串\n      var f = this.file;\n      var reader = new FileReader();\n      //if (!FileReader.prototype.readAsBinaryString) {\n      FileReader.prototype.readAsBinaryString = function (f) {\n        var binary = \"\";\n        var rABS = false; //是否将文件读取为二进制字符串\n        var pt = this;\n        var wb; //读取完成的数据\n        var outdata;\n        var reader = new FileReader();\n        reader.onload = function (e) {\n          var bytes = new Uint8Array(reader.result);\n          var length = bytes.byteLength;\n          for (var i = 0; i < length; i++) {\n            binary += String.fromCharCode(bytes[i]);\n          }\n          var XLSX = require(\"xlsx\");\n          if (rABS) {\n            wb = XLSX.read(btoa(fixdata(binary)), {\n              //手动转化\n              type: \"base64\",\n            });\n          } else {\n            wb = XLSX.read(binary, {\n              type: \"binary\",cellDates: true, dateNF: 'yyyy/mm/dd;@'\n            });\n          }\n          outdata = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]],{raw: false}); //outdata就是你想要的东西\n          // console.log('未处理的原始数据如下：');\n          console.log('outdata',outdata);\n          //此处可对数据进行处理\n          let arr = [];\n          outdata.map((v) => {\n            let obj = {};\n            let nameTemp = [];\n            // console.log(\"obj\", obj)\n            obj.fullname = v[\"Fullname\"];\n            obj.username = v[\"Username\"];\n            obj.email = v[\"Email\"];\n            obj.password = v[\"Password\"];\n            obj.phone = v[\"Telephone\"];\n            obj.gender = v[\"Gender\"];\n            nameTemp = obj.email.split('@');\n            var birthdayTemp = v[\"Birthday\"];\n            // console.log(\"XXX\", birthdayTemp)\n            var birthdayArray = birthdayTemp.split(\"/\");\n            var birthday = new Date(birthdayArray[2],birthdayArray[1],birthdayArray[0])\n            obj.birthdayYear = parseInt(birthdayArray[2]);\n            obj.birthdayMonth = birthday.getMonth();\n            obj.birthdayDate = birthday.getDate();\n            arr.push(obj);\n          });\n          _this.da = arr;\n          _this.dalen = arr.length;\n          console.log('data',_this.da )\n          console.log('dataleng',_this.dalen )\n          console.log('arr',arr )\n          return arr;\n        };\n        reader.readAsArrayBuffer(f);\n      };\n      // console.log(this.da)\n      if (rABS) {\n        reader.readAsArrayBuffer(f);\n      } else {\n        reader.readAsBinaryString(f);\n      }\n    },\n    handleUpload() {\n      // console.log(this.da);\n      let url = \"http://localhost:8000/api/admin/teacher/upload/\"+this.$route.params.id;\n      console.log(\"url\",url)\n      let payload = {\n        data: [],\n      };\n      payload.data = this.da;\n      console.log('payload',payload.data);\n      post(url, payload)\n        .then((res) => {\n          console.log(\"Respon\", res);\n        if(res.data.count <0){\n            this.showNotification(\"danger\",\"Học sinh thuộc lớp không có trong hệ thống\")\n        this.handleRemove();\n        }else\n        {\n          this.showNotification(\"success\",\"Đã lưu dữ liệu thành công\")\n        this.handleRemove();\n        }\n        })\n        .catch((err) => {\n        //   alert(err);\n        console.log(\"Respon\", err);\n        this.showNotification(\"danger\",\"Dữ liệu không hợp lệ\")\n        this.handleRemove();\n        });\n    },\n    showNotification(type,message){\n      this.$notify({\n              message:\n                message,\n              icon: \"add_alert\",\n              horizontalAlign: 'right',\n              verticalAlign: 'top',\n              type: type,\n            });\n    },\n  },\n  // mounted(file,fileList){\n  //   this.handleChange(file,fileList);\n  // }\n};\n</script>\n<style>\n.el-upload, .margin-center{\n  margin: 2.5rem 32.5rem;\n}\n.title{\n  margin: 2.5rem;\n  text-align: center;\n}\n.el-table .cell {\n    word-break: break-word;\n}\n</style>"],"sourceRoot":"src/views/admins"}]}